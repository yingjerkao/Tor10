

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>tor10.UniTensor &mdash; Tor10 0.3 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tor10.Network" href="Network.html" />
    <link rel="prev" title="tor10.Bond" href="Bond.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Tor10
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Symmetry.html">tor10.Symmetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bond.html">tor10.Bond</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">tor10.UniTensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="Network.html">tor10.Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="linalg.html">tor10.linalg</a></li>
<li class="toctree-l1"><a class="reference internal" href="nn.html">tor10.nn</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Tor10</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>tor10.UniTensor</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tor10-unitensor">
<h1>tor10.UniTensor<a class="headerlink" href="#tor10-unitensor" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="tor10.UniTensor.UniTensor">
<em class="property">class </em><code class="descclassname">tor10.UniTensor.</code><code class="descname">UniTensor</code><span class="sig-paren">(</span><em>self</em>, <em>bonds</em>, <em>rowrank=None</em>, <em>labels=None</em>, <em>device=torch.device(&quot;cpu&quot;)</em>, <em>dtype=torch.float64</em>, <em>is_diag=False</em>, <em>requires_grad=False</em>, <em>name=&quot;&quot;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="tor10.UniTensor.UniTensor.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>self</em>, <em>bonds</em>, <em>rowrank=None</em>, <em>labels=None</em>, <em>device=torch.device(&quot;cpu&quot;)</em>, <em>dtype=torch.float64</em>, <em>is_diag=False</em>, <em>requires_grad=False</em>, <em>name=&quot;&quot;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the constructor of UniTensor.</p>
<p>Public Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>bonds:</dt>
<dd>List of bonds.
It should be an list or np.ndarray with len(list) being the number of bonds.</dd>
<dt>rowrank:</dt>
<dd>The number of bonds in row-space.
The first [rowrank] bonds will be define as the row-space (which means the row space when flatten as Matrix), and the other bonds will be defined as in the col-space (which is the column space when flatten as Matrix).
When interprete the memory layout as Matrix, the combine of first rowrank bonds will be the row and the other bond will be column.</dd>
<dt>labels:</dt>
<dd>The label of each bond.
1. the number of elements should be the same as the total rank of the tensor, contain no duplicated elements.
2. all the label should be integer. if the label is specify as floating point, it will be rounded as integer.</dd>
<dt>device:</dt>
<dd>This should be a [torch.device]. When provided, the tensor will be put on the device (“cpu”, “cuda”, “cuda:x” with x is the GPU-id. See torch.device for further information.)</dd>
<dt>dtype :</dt>
<dd>This should be a [ torch.dtype ].
<a href="#id1"><span class="problematic" id="id2">*</span></a>The default type is float with either float32 or float64 which follows the same internal rule of pytorch. For further information, see pytorch documentation.</dd>
<dt>is_diag:</dt>
<dd>This states if the current UniTensor is a diagonal matrix or not. If True, the Storage will only store diagonal elements.
Note that if is_diag=True, then the UniTensor is strictly required to be a square rank-2 tensor.</dd>
<dt>requires_grad:</dt>
<dd>Activate the autograd function for UniTensor. This is the same as torch.Tensor</dd>
<dt>name:</dt>
<dd>This states the name of current UniTensor.</dd>
</dl>
</div></blockquote>
<p>Example for how to create a UniTensor:</p>
<blockquote>
<div><ul class="simple">
<li>create a rank-2 untagged UniTensor (matrix) with shape (3,4):</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">(</span><span class="n">bond_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     0 ____| 3         4 |____ 1  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------      </span>
<span class="go">lbl:0 Dim = 3 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:1 Dim = 4 |</span>
<span class="go">REG     :</span>
</pre></div>
</div>
<ul class="simple">
<li>create a rank-3 untagged UniTensor with one bond in row-space and two bonds in col-space, shape (3,4,5) and set labels [-3,4,1] for each bond:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">(</span><span class="n">bond_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">    -3 ____| 3         4 |____ 4  </span>
<span class="go">           |             |     </span>
<span class="go">           |           5 |____ 1  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------      </span>
<span class="go">lbl:-3 Dim = 3 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:4 Dim = 4 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:1 Dim = 5 |</span>
<span class="go">REG     :</span>
</pre></div>
</div>
<ul class="simple">
<li>create a rank-0 UniTensor</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rk0t</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rk0t</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 0</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rk0t</span><span class="p">)</span>
<span class="go">Tensor name: </span>
<span class="go">is_diag    : False</span>
<span class="go">tensor(0., dtype=torch.float64) </span>
</pre></div>
</div>
<ul class="simple">
<li>create a rank-3 tagged UniTensor with two bonds in row-space and two bonds in col-space, shape (2,3,4,5)</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds</span>  <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds</span><span class="p">,</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">o</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">braket_form : True</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">     0 &gt; __| 2         4 |__ &lt; 2  </span>
<span class="go">           |             |     </span>
<span class="go">     1 &gt; __| 3         5 |__ &lt; 3  </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------  </span>
</pre></div>
</div>
<ul class="simple">
<li>note that if the BRA bond is not in the col-space, or KET bond is not in the row-space, the tensor is in the so called “non-braket_form, which will have a * symbol indicating the mismatch.”</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bd2</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_mismatch</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bd2</span><span class="p">,</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c_mismatch</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">braket_form : False</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">     0 &gt; __| 2         4 |__ &lt; 2  </span>
<span class="go">           |             |     </span>
<span class="go">     1 &lt;*__| 5         3 |__*&gt; 3  </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------  </span>
</pre></div>
</div>
<ul class="simple">
<li>create a rank-2 UniTensor with one inbond, one outbond, shape (3,4) on GPU-0:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">))</span>
</pre></div>
</div>
<ul class="simple">
<li>create a diagonal 6x6 rank-2 tensor(matrix):
Note that if is_diag is True, rowrank must be 1.</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that when is_diag is set to True, the UniTensor should be a square matrix.</p>
<ul class="simple">
<li>create a rank-3 UniTensor with two bonds in row-space and one bond in col-space, and single precision:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>create a rank-3 UniTensor with U1 symmetry:</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bd_sym_1</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bd_sym_2</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bd_sym_3</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symT</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">bd_sym_1</span><span class="p">,</span><span class="n">bd_sym_2</span><span class="p">,</span><span class="n">bd_sym_3</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">symT</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">(</span><span class="n">bond_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : True</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">    10 &gt; __| 3         5 |__ &lt; 12 </span>
<span class="go">           |             |     </span>
<span class="go">    11 &gt; __| 4           |        </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------    </span>
<span class="go">lbl:10 Dim = 3 |</span>
<span class="go">KET     : U1::  +2 +1 +0</span>
<span class="go">_</span>
<span class="go">lbl:11 Dim = 4 |</span>
<span class="go">KET     : U1::  +2 +2 +0 -1</span>
<span class="go">_        </span>
<span class="go">lbl:12 Dim = 5 |</span>
<span class="go">BRA     : U1::  +5 +4 +2 +1 -1</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.__eq__">
<code class="descname">__eq__</code><span class="sig-paren">(</span><em>rhs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.__eq__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.__eq__" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two UniTensor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
</pre></div>
</div>
<p>where a &amp; b are UniTensors.</p>
<p>Note that this will only compare the shape of Storage. Not the content of torch tensor.</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.CombineBonds">
<code class="descname">CombineBonds</code><span class="sig-paren">(</span><em>X_to_combine</em>, <em>new_label=None</em>, <em>permute_back=False</em>, <em>by_label=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.CombineBonds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.CombineBonds" title="Permalink to this definition">¶</a></dt>
<dd><p>This function combines the bonds in input UniTensor [a] by the specified labels [label].</p>
<p>[Note][v0.3+] that ket-bonds can only be combine with ket-bonds, bra-bonds can only combine with bra-bonds.</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>labels_to_combine:</dt>
<dd>labels that to be combined. It should be a int list / numpy array of the label. All the bonds with specified labels in the current UniTensor  will be combined</dd>
<dt>new_label [default=None]</dt>
<dd><p class="first">This should be an integer, for floating point number, it will be truncated to integer.</p>
<p>if new_label is set to None, the combined bond will have label as the bond in the to-be-combined bonds that has the smallest LABEL in input tensor.</p>
<p class="last">if new_label is set, the combined bond will have label [new_label]</p>
</dd>
<dt>permuted_back[False]:</dt>
<dd>this state if the combine bond should be permuted back or not. If false, the combined bond will always presented as the first bond.</dd>
</dl>
</div></blockquote>
<p>Example:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Combine Bond for an non-symmetric tensor.</li>
</ol>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 5         3 |____ 5  </span>
<span class="go">           |             |     </span>
<span class="go">     3 ____| 5           |        </span>
<span class="go">           \             /     </span>
<span class="go">            -------------      </span>
<span class="go">lbl:4 Dim = 5 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:3 Dim = 5 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:5 Dim = 3 |</span>
<span class="go">REG     :</span>
</pre></div>
</div>
<ul class="simple">
<li>combine bond with label “3” into “5”</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">CombineBonds</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 5        15 |____ 5  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------      </span>
<span class="go">lbl:4 Dim = 5 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:5 Dim = 15 |</span>
<span class="go">REG     :</span>
</pre></div>
</div>
<ul class="simple">
<li>combine bond with label “5” into “3”</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">CombineBonds</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 5           |        </span>
<span class="go">           |             |     </span>
<span class="go">     3 ____| 15          |        </span>
<span class="go">           \             /     </span>
<span class="go">            -------------      </span>
<span class="go">lbl:4 Dim = 5 |</span>
<span class="go">REG     :</span>
<span class="go">_</span>
<span class="go">lbl:3 Dim = 15 |</span>
<span class="go">REG     :</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>  <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 6</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 5         5 |____ 6  </span>
<span class="go">           |             |     </span>
<span class="go">     3 ____| 5         5 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">     5 ____| 3         3 |____ 8  </span>
<span class="go">           \             /     </span>
<span class="go">            ------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">CombineBonds</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 225       5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">           |           5 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">           |           3 |____ 8  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------   </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span><span class="o">.</span><span class="n">CombineBonds</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">permute_back</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 225       5 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">     3 ____| 5         3 |____ 8  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Contiguous">
<code class="descname">Contiguous</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Contiguous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Contiguous" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the memory to be contiguous. This is similar as pytorch’s contiguous().
Because of the Permute does not move the memory, after permute, only the shape of UniTensor is changed, the underlying memory does not change. The UniTensor in this status is called “non-contiguous” tensor.
When call the Contiguous(), the memory will be moved to match the shape of UniTensor.</p>
<p>if the current tensor is already in contiguous, return self. Otherwise, return a new tensor.</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>self</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Tt</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">Contiguous</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Contiguous_">
<code class="descname">Contiguous_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Contiguous_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Contiguous_" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the memory to be contiguous. This is similar as pytorch’s contiguous_().
Because of the Permute does not move the memory, after permute, only the shape of UniTensor is changed, the underlying memory does not change. The UniTensor in this status is called “non-contiguous” tensor.
When call the Contiguous_(), the memory will be moved to match the shape of UniTensor.
<em>Note</em> Normally, it is not nessary to call contiguous. Most of the linalg function implicity will make the UniTensor contiguous. If one calls a function that requires a contiguous tensor, the error will be issue. Then you know you have to put UniTensor.Contiguous() or UniTensor.Contiguous_() there.</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>self</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Tt</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Contiguous_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Det">
<code class="descname">Det</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Det"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Det" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the member function of Det, see tor10.linalg.Det</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.GetBlock">
<code class="descname">GetBlock</code><span class="sig-paren">(</span><em>*qnum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.GetBlock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.GetBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Block specify by the quantum number(s). If the UniTensor is non-symmetry, return self.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt><a href="#id3"><span class="problematic" id="id4">*</span></a>qnum:</dt>
<dd>The quantum number(s). Note that when get-block on a High-rank tensor, the quantum number represent the total quantum number of all the in(out)-bonds.</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd><ul class="first last simple">
<li>UniTensor, rank-2 (for symmetry tensor)</li>
<li>a new rank-2 flattened UniTensor (for non-symmetry tensor)</li>
</ul>
</dd>
<dt>Example:</dt>
<dd><ul class="first">
<li><p class="first">Single Symmetry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd_sym_1</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">bd_sym_2</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">bd_sym_3</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">sym_T</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">bd_sym_1</span><span class="p">,</span><span class="n">bd_sym_2</span><span class="p">,</span><span class="n">bd_sym_3</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_T</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : True</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">    10 &gt; __| 3         5 |__ &lt; 12 </span>
<span class="go">           |             |     </span>
<span class="go">    11 &gt; __| 4           |        </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q_in</span><span class="p">,</span> <span class="n">q_out</span> <span class="o">=</span> <span class="n">sym_T</span><span class="o">.</span><span class="n">GetTotalQnums</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q_in</span><span class="p">)</span>
<span class="go">Dim = 12 |</span>
<span class="go">KET     : U1::  +4 +4 +2 +1 +3 +3 +1 +0 +2 +2 +0 -1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">q_out</span><span class="p">)</span>
<span class="go">Dim = 5 |</span>
<span class="go">BRA     : U1::  +5 +4 +2 +2 +1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bk2</span> <span class="o">=</span> <span class="n">sym_T</span><span class="o">.</span><span class="n">GetBlock</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bk2</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     0 ____| 3         2 |____ 1  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bk2</span><span class="p">)</span>
<span class="go">Tensor name: </span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [0., 0.],</span>
<span class="go">        [0., 0.]], dtype=torch.float64)</span>
</pre></div>
</div>
<ul>
<li><p class="first">Multiple Symmetry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## multiple Qnum:</span>
<span class="c1">## U1 x U1 x U1 x U1</span>
<span class="n">bd_sym_1</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                            <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">bd_sym_2</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">bd_sym_3</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>

<span class="n">sym_T</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">bd_sym_1</span><span class="p">,</span><span class="n">bd_sym_2</span><span class="p">,</span><span class="n">bd_sym_3</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tqin</span><span class="p">,</span> <span class="n">tqout</span> <span class="o">=</span> <span class="n">sym_T</span><span class="o">.</span><span class="n">GetTotalQnums</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqin</span><span class="p">)</span>
<span class="go">Dim = 12 |</span>
<span class="go">KET     : U1::  +4 +3 +2 +1 +3 +2 +1 +0 +2 +1 +0 -1</span>
<span class="go">          U1::  -3 -1 -1 -1 -1 +1 +1 +1 +0 +2 +2 +2</span>
<span class="go">          U1::  +0 +2 +0 +0 -2 +0 -2 -2 +0 +2 +0 +0</span>
<span class="go">          U1::  +1 +0 +2 +3 +2 +1 +3 +4 +1 +0 +2 +3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqout</span><span class="p">)</span>
<span class="go">Dim = 2 |</span>
<span class="go">BRA     : U1::  +1 -1</span>
<span class="go">          U1::  +1 -2</span>
<span class="go">          U1::  -2 -1</span>
<span class="go">          U1::  +3 +2</span>
</pre></div>
</div>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">block_1123</span> <span class="o">=</span> <span class="n">sym_T</span><span class="o">.</span><span class="n">GetBlock</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">block_1123</span><span class="p">)</span>
<span class="go">Tensor name: </span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[0.]], dtype=torch.float64)</span>
</pre></div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.GetTotalQnums">
<code class="descname">GetTotalQnums</code><span class="sig-paren">(</span><em>physical=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.GetTotalQnums"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.GetTotalQnums" title="Permalink to this definition">¶</a></dt>
<dd><p>Return two combined bond objects that has the information for the total qnums at bra and ket bonds.</p>
<p>Args:</p>
<blockquote>
<div><p>physical [default: False]:</p>
<blockquote>
<div><p>Return the physical total qnums.</p>
<p>If True, the return qnums_brabonds will be the physical qnums of all bonds tagged by BD_BRA, and qnums_ketbonds will be the physical qnums of all bonds tagged by BD_KET.</p>
<p>If False, the return qnums will be the qnums of all bonds in row-space, the mismatch bond will have reversed qnums upon combined. This will match the layout of current blocks.</p>
</div></blockquote>
</div></blockquote>
<dl class="docutils">
<dt>Return:</dt>
<dd><p class="first">qnums_brabonds, qnums_ketbonds:</p>
<dl class="last docutils">
<dt>qnums_brabonds:</dt>
<dd>a tor10.Bond, the combined bra-bond</dd>
<dt>qnums_ketbonds:</dt>
<dd>a tor10.Bond, the combined ket-bond.</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<blockquote>
<div><ul>
<li><p class="first">Multiple Symmetry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## multiple Qnum:</span>
<span class="c1">## U1 x U1 x U1 x U1</span>
<span class="c1">## U1 = {-2,-1,0,1,2}</span>
<span class="c1">## U1 = {-1,1}</span>
<span class="c1">## U1 = {0,1,2,3}</span>
<span class="n">bd_sym_1</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                            <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                                            <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="n">bd_sym_2</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">bd_sym_3</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>

<span class="n">sym_T</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">bd_sym_1</span><span class="p">,</span><span class="n">bd_sym_2</span><span class="p">,</span><span class="n">bd_sym_3</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_T</span><span class="o">.</span><span class="n">Pring_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : True</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">     1 &gt; __| 3         2 |__ &lt; 3  </span>
<span class="go">           |             |     </span>
<span class="go">     2 &gt; __| 4           |        </span>
<span class="go">           |             |     </span>
<span class="go">           --------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tqin</span><span class="p">,</span> <span class="n">tqout</span> <span class="o">=</span> <span class="n">sym_T</span><span class="o">.</span><span class="n">GetTotalQnums</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqin</span><span class="p">)</span>
<span class="go">Dim = 12 |</span>
<span class="go">KET     : U1::  +4 +3 +2 +1 +3 +2 +1 +0 +2 +1 +0 -1</span>
<span class="go">          U1::  -3 -1 -1 -1 -1 +1 +1 +1 +0 +2 +2 +2</span>
<span class="go">          U1::  +0 +2 +0 +0 -2 +0 -2 -2 +0 +2 +0 +0</span>
<span class="go">          U1::  +1 +0 +2 +3 +2 +1 +3 +4 +1 +0 +2 +3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqout</span><span class="p">)</span>
<span class="go">Dim = 2 |</span>
<span class="go">BRA     : U1::  +1 -4</span>
<span class="go">          U1::  +1 +3</span>
<span class="go">          U1::  -2 +0</span>
<span class="go">          U1::  +3 -1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_T</span><span class="o">.</span><span class="n">SetRowRank</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym_T</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : False</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">     1 &gt; __| 3         4 |__*&gt; 2  </span>
<span class="go">           |             |     </span>
<span class="go">           |           2 |__ &lt; 3  </span>
<span class="go">           |             |   </span>
<span class="go">           --------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tqin2</span><span class="p">,</span><span class="n">tqout2</span> <span class="o">=</span>  <span class="n">sym_T</span><span class="o">.</span><span class="n">GetTotalQnums</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqin2</span><span class="p">)</span>
<span class="go">Dim = 2 |</span>
<span class="go">KET     : U1::  -1 +1</span>
<span class="go">          U1::  -2 +1</span>
<span class="go">          U1::  -1 -2</span>
<span class="go">          U1::  +2 +3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqout2</span><span class="p">)</span>
<span class="go">Dim = 8 |</span>
<span class="go">BRA     : U1::  -1 -6 +0 -5 +1 -4 +2 -3</span>
<span class="go">          U1::  +3 +5 +1 +3 +1 +3 +1 +3</span>
<span class="go">          U1::  -1 +1 -3 -1 -1 +1 -1 +1</span>
<span class="go">          U1::  +2 -2 +3 -1 +1 -3 +0 -4</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tqin2_phy</span><span class="p">,</span> <span class="n">tqout2_phy</span> <span class="o">=</span> <span class="n">sym_T</span><span class="o">.</span><span class="n">GetTotalQnums</span><span class="p">(</span><span class="n">physical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqin2_phy</span><span class="p">)</span>
<span class="go">Dim = 12 |</span>
<span class="go">KET     : U1::  +4 +3 +2 +1 +3 +2 +1 +0 +2 +1 +0 -1</span>
<span class="go">          U1::  -3 -1 -1 -1 -1 +1 +1 +1 +0 +2 +2 +2</span>
<span class="go">          U1::  +0 +2 +0 +0 -2 +0 -2 -2 +0 +2 +0 +0</span>
<span class="go">          U1::  +1 +0 +2 +3 +2 +1 +3 +4 +1 +0 +2 +3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqout2_phy</span><span class="p">)</span>
<span class="go">Dim = 2 |</span>
<span class="go">BRA     : U1::  +1 -4</span>
<span class="go">          U1::  +1 +3</span>
<span class="go">          U1::  -2 +0</span>
<span class="go">          U1::  +3 -1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqin2</span> <span class="o">==</span> <span class="n">tqin</span>  <span class="p">)</span> <span class="c1">## this should be False</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqout2</span> <span class="o">==</span> <span class="n">tqout</span><span class="p">)</span> <span class="c1">## this should be False</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqin2_phy</span> <span class="o">==</span> <span class="n">tqin</span><span class="p">)</span> <span class="c1">## this should be true</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">tqout2_phy</span> <span class="o">==</span> <span class="n">tqout</span><span class="p">)</span> <span class="c1">## this should be true</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.GetValidQnums">
<code class="descname">GetValidQnums</code><span class="sig-paren">(</span><em>physical=False</em>, <em>return_shape=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.GetValidQnums"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.GetValidQnums" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quatum number set that has a valid block.</p>
<p>Args:</p>
<blockquote>
<div><p>physical [default: False]:</p>
<blockquote>
<div><p>if set to True, return the unique quantum number sets defined by BD_BRA and BD_KET.</p>
<p>The return 2D array has shape (# of blocks,qnum set)</p>
</div></blockquote>
<p>return_shape [default: False]:</p>
<blockquote>
<div>if set to True, return a 2D array with shape (# of blocks, size of each block)</div></blockquote>
</div></blockquote>
<p>Return</p>
<blockquote>
<div>if return_shape == False: return [qnum sets, 2D ndarray]  
if return_shape == True : return [qnum sets, 2D ndarray], [shape (2D ndarray)]</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Matmul">
<code class="descname">Matmul</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Matmul"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Matmul" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the member function of Matmul, see tor10.linalg.Matmul</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Norm">
<code class="descname">Norm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Norm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Norm" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the member function of Norm, see tor10.linalg.Norm</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Permute">
<code class="descname">Permute</code><span class="sig-paren">(</span><em>mapper</em>, <em>rowrank=None</em>, <em>by_label=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Permute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Permute" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute the bonds of the UniTensor.</p>
<blockquote>
<div>[Note] the computation complexity of Permute is O(1) which is very fast. The permute will not change the underlying memory layout. It will put the tensor into a “non-contiguous” status. Call Contiguous() or Contiguous_() when actually need to move memory.</div></blockquote>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>mapper:</dt>
<dd>a python list or 1d numpy array with integer type elements that the UniTensor permute accroding to. if by_label=False, the in_mapper will use index as mapper.</dd>
<dt>by_label: [default False]</dt>
<dd>bool, when True, the mapper using the labels. When False, the mapper using the index.</dd>
<dt>rowrank: [default: current rowrank]</dt>
<dd>uint, the rank of row space. If not set, it is equal to the current Tensor’s rank of row space.</dd>
</dl>
</dd>
</dl>
<p>Return:</p>
<blockquote>
<div>self</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 5</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     1 ____| 6         3 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">     3 ____| 5         2 |____ 8  </span>
<span class="go">           |             |     </span>
<span class="go">     5 ____| 4           |        </span>
<span class="go">           \             /     </span>
<span class="go">            ------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 5</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     1 ____| 6         2 |____ 8  </span>
<span class="go">           |             |     </span>
<span class="go">     5 ____| 4         3 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">     3 ____| 5           |        </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 5</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     3 ____| 5         3 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">     1 ____| 6         2 |____ 8  </span>
<span class="go">           |             |     </span>
<span class="go">     5 ____| 4           |        </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">by_label</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 5</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     3 ____| 5         4 |____ 5  </span>
<span class="go">           |             |     </span>
<span class="go">     1 ____| 6         3 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">           |           2 |____ 8  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Print_diagram">
<code class="descname">Print_diagram</code><span class="sig-paren">(</span><em>bond_info=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Print_diagram"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Print_diagram" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the beauty print of the tensor diagram. Including the information for the placeing device</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span><span class="n">The</span> <span class="n">left</span> <span class="n">hand</span> <span class="n">side</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">the</span> <span class="ow">in</span><span class="o">-</span><span class="n">bonds</span><span class="p">,</span><span class="n">representing</span> <span class="n">the</span> <span class="n">row</span><span class="o">-</span><span class="n">space</span> <span class="n">when</span> <span class="n">flatten</span> <span class="k">as</span> <span class="n">Matrix</span><span class="p">;</span> <span class="n">the</span> <span class="n">right</span> <span class="n">hand</span> <span class="n">side</span> <span class="ow">is</span> <span class="n">always</span> <span class="n">the</span> <span class="n">Out</span><span class="o">-</span><span class="n">bonds</span><span class="p">,</span> <span class="n">representing</span> <span class="n">the</span> <span class="n">column</span><span class="o">-</span><span class="n">space</span> <span class="n">when</span> <span class="n">flatten</span> <span class="k">as</span> <span class="n">Matrix</span><span class="o">.</span>
<span class="mf">2.</span><span class="n">The</span> <span class="n">number</span> <span class="n">attach</span> <span class="n">to</span> <span class="n">the</span> <span class="n">out</span><span class="o">-</span><span class="n">side</span> <span class="n">of</span> <span class="n">each</span> <span class="n">leg</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">Bond</span><span class="o">-</span><span class="n">dimension</span><span class="o">.</span>
<span class="mf">3.</span><span class="n">The</span> <span class="n">number</span> <span class="n">attach</span> <span class="n">to</span> <span class="n">the</span> <span class="ow">in</span><span class="o">-</span><span class="n">side</span> <span class="n">of</span> <span class="n">each</span> <span class="n">leg</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">label</span><span class="o">.</span>
<span class="mf">4.</span><span class="k">if</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">bra</span><span class="o">-</span><span class="n">bonds</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">row</span><span class="o">-</span><span class="n">space</span> <span class="p">(</span><span class="ow">in</span><span class="o">-</span><span class="n">bonds</span><span class="p">),</span> <span class="ow">and</span> <span class="nb">all</span> <span class="n">ket</span><span class="o">-</span><span class="n">bonds</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">col</span><span class="o">-</span><span class="n">space</span> <span class="p">(</span><span class="n">out</span><span class="o">-</span><span class="n">bonds</span><span class="p">),</span> <span class="n">the</span> <span class="n">tensor</span> <span class="ow">is</span> <span class="ow">in</span> <span class="s2">&quot;braket_form&quot;</span><span class="o">.</span> 
<span class="mf">5.</span><span class="k">if</span> <span class="n">one</span> <span class="n">permute</span> <span class="n">bra</span><span class="o">-</span><span class="n">bonds</span> <span class="n">that</span> <span class="n">should</span> <span class="n">be</span> <span class="ow">in</span><span class="o">-</span><span class="n">bonds</span> <span class="n">to</span> <span class="n">out</span><span class="o">-</span><span class="n">bonds</span><span class="p">,</span> <span class="n">this</span> <span class="n">will</span> <span class="n">put</span> <span class="n">the</span> <span class="n">UniTensor</span> <span class="ow">in</span> <span class="n">a</span> <span class="s2">&quot;non-braket_form&quot;</span><span class="o">.</span> <span class="n">the</span> <span class="n">bond</span> <span class="n">will</span> <span class="n">have</span> <span class="n">a</span> <span class="s2">&quot;*&quot;</span> <span class="n">symbol</span> <span class="n">on</span> <span class="n">it</span><span class="o">.</span> 
</pre></div>
</div>
<p>Args:</p>
<blockquote>
<div><p>bond_info [default: False]</p>
<blockquote>
<div>if set to True, the info of each bond will be printed.</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.PutBlock">
<code class="descname">PutBlock</code><span class="sig-paren">(</span><em>block</em>, <em>*qnum</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.PutBlock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.PutBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Put the block into the UniTensor. If the UniTensor is symmetry tensor, the block should be specify by the quantum number.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>block:</dt>
<dd>A UniTensor with rank-2</dd>
<dt><a href="#id5"><span class="problematic" id="id6">*</span></a>qnum:</dt>
<dd>The quantum number set that specify the block.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Rand">
<code class="descname">Rand</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Rand"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Rand" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomize the UniTensor.</p>
<blockquote>
<div>Note that in current version, only a UniTensor without symmetry quantum numbers can be randomized.</div></blockquote>
<dl class="docutils">
<dt>Return:</dt>
<dd>self</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Reshape">
<code class="descname">Reshape</code><span class="sig-paren">(</span><em>dimer</em>, <em>rowrank</em>, <em>new_labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Reshape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new reshaped UniTensor into the shape specified as [dimer], with the first [rowrank] Bonds as bra-bond and other bonds as ket-bond.</p>
<p>[Note]</p>
<blockquote>
<div><p>1.Reshaping a UniTensor physically re-define the new basis, which construct a new physical definition tensor that has the same element.</p>
<p>2.Reshape can only operate on an untagged tensor.</p>
</div></blockquote>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>dimer:</dt>
<dd>The new shape of the UniTensor. This should be a python list.</dd>
<dt>rowrank:</dt>
<dd>The number of bonds in row space.</dd>
<dt>new_labels:</dt>
<dd>The new labels that will be set for new bonds after reshape.</dd>
</dl>
</div></blockquote>
<p>reture:</p>
<blockquote>
<div>UniTensor</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 6         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">           |           3 |____ 5  </span>
<span class="go">           \             /     </span>
<span class="go">            ------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">Reshape</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">new_labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     1 ____| 2         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">     2 ____| 3         3 |____ -1 </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Reshape_">
<code class="descname">Reshape_</code><span class="sig-paren">(</span><em>dimer</em>, <em>rowrank</em>, <em>new_labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Reshape_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Reshape_" title="Permalink to this definition">¶</a></dt>
<dd><p>Inplace version of Reshape. 
Reshape UniTensor into the shape specified as [dimer], with the first [rowrank] Bonds as bra-bond and other bonds as ket-bond.</p>
<p>[Note]</p>
<blockquote>
<div><p>1.Reshapeing a UniTensor physically re-define the bra-ket basis space, which construct a new physical definition tensor that has the same element.</p>
<p>2.Reshape can only operate on an untagged tensor.</p>
</div></blockquote>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>dimer:</dt>
<dd>The new shape of the UniTensor. This should be a python list.</dd>
<dt>rowrank:</dt>
<dd>The number of bonds in row space.</dd>
<dt>new_labels [option]:</dt>
<dd>The new labels that will be set for new bonds after reshape. If not set, the label will be initialize using default enumerate rule.</dd>
</dl>
</div></blockquote>
<p>Return:</p>
<blockquote>
<div>self</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 6         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">           |           3 |____ 5  </span>
<span class="go">           \             /     </span>
<span class="go">            ------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Reshape_</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">new_labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     1 ____| 2         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">     2 ____| 3         3 |____ -1 </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.SetElem">
<code class="descname">SetElem</code><span class="sig-paren">(</span><em>elem</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.SetElem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.SetElem" title="Permalink to this definition">¶</a></dt>
<dd><p>Given 1D array of elements, set the elements stored in tensor as the same as the given ones. Note that elem can only be python-list or numpy</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>elem:</dt>
<dd>The elements to be replace the content of the current UniTensor. It should be a 1D array.
<strong>Note</strong> if the UniTensor is a tensor with symmetry, one should use UniTensor.PutBlock to set the elements.</dd>
</dl>
</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sz</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                  <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span>
                  <span class="n">device</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span>
<span class="n">Sz</span><span class="o">.</span><span class="n">SetElem</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span> <span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Sz</span><span class="p">)</span>
<span class="go">Tensor name: </span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[ 1.,  0.],</span>
<span class="go">        [ 0., -1.]], dtype=torch.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.SetLabel">
<code class="descname">SetLabel</code><span class="sig-paren">(</span><em>newLabel</em>, <em>idx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.SetLabel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.SetLabel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a new label for the bond at index :idx:</p>
<p>Args:</p>
<blockquote>
<div><p>newLabel: The new label, it should be an integer.</p>
<p>idx     : The index of the bond. when specified, the label of the bond at this index will be changed.</p>
</div></blockquote>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">labels</span>
<span class="go">[5 6]</span>
</pre></div>
</div>
<p>Set “-1” to replace the original label “6” at index 1</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">labels</span>
<span class="go">[5 -1]</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.SetLabels">
<code class="descname">SetLabels</code><span class="sig-paren">(</span><em>newlabels</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.SetLabels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.SetLabels" title="Permalink to this definition">¶</a></dt>
<dd><p>Set new labels for all the bonds.</p>
<p>Args:</p>
<blockquote>
<div>newLabels: The list of new labels, it should be a list or numpy array with size equal to the number of bonds of the UniTensor.</div></blockquote>
<p>Example:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">labels</span>
<span class="go">[5 6]</span>
</pre></div>
</div>
<p>Set new_label=[-1,-2] to replace the original label [5,6].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_label</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">SetLabels</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">labels</span>
<span class="go">[-1 -2]</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.SetName">
<code class="descname">SetName</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.SetName"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.SetName" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of the UniTensor</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>name:</dt>
<dd>a string.</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.SetRowRank">
<code class="descname">SetRowRank</code><span class="sig-paren">(</span><em>new_rowrank</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.SetRowRank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.SetRowRank" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the RowRank while keep the tensor indices.</p>
<blockquote>
<div><p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>new_rowrank: </dt>
<dd><p class="first">should be a unsigned int.</p>
<p class="last">[Note] for UniTensor with symmetry, it should have at least one bond in row-space and one bond in col-space. which means rowrank must &gt;=1 and &lt;= (rank of UniTensor)-1</p>
</dd>
</dl>
</div></blockquote>
<p>Return:</p>
<blockquote>
<div>self</div></blockquote>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Svd">
<code class="descname">Svd</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Svd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Svd" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the member function of Svd, see tor10.linalg.Svd()</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Svd_truncate">
<code class="descname">Svd_truncate</code><span class="sig-paren">(</span><em>keepdim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Svd_truncate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Svd_truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the member function of Svd_truncate, see tor10.linalg.Svd_truncate()</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Todense">
<code class="descname">Todense</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Todense"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Todense" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a densed version of current UniTensor. This only affect on UniTensor with non-symmetry with is_diag=True.</p>
<blockquote>
<div>[Note] for UniTensor with Symmetry, Todense cannot be called.</div></blockquote>
<dl class="docutils">
<dt>Return:</dt>
<dd>new UniTensor if current tensor is_diag=True, otherwise return self.</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_diag</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dense_a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">Todense</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dense_a</span><span class="o">.</span><span class="n">is_diag</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_diag</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Todense_">
<code class="descname">Todense_</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Todense_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Todense_" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Set the current UniTensor to dense matrix.</dt>
<dd>[v0.3+] This only affect on UniTensor with non-symmetry with diag=True.</dd>
<dt>Return:</dt>
<dd>self</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">is_diag</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">SetElem</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_diag</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Tensor name: </span>
<span class="go">is_diag    : True</span>
<span class="go">tensor([1., 2., 3.], dtype=torch.float64)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">Todense_</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">is_diag</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">Tensor name: </span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[1., 0., 0.],</span>
<span class="go">        [0., 2., 0.],</span>
<span class="go">        [0., 0., 3.]], dtype=torch.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.View">
<code class="descname">View</code><span class="sig-paren">(</span><em>dimer</em>, <em>rowrank</em>, <em>new_labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.View"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.View" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new view of UniTensor into the shape specified as [dimer], with the first [rowrank] Bonds as bra-bond and other bonds as ket-bond.</p>
<p>The View() can only operate on a contiguous tensor, otherwise, Contiguous_() or Contiguous() need to be called before the tensor can be viewed. This is the same as pytorch.view().</p>
<p>[Note]</p>
<blockquote>
<div><p>1.View a UniTensor physically re-define the new basis, which construct a new physical definition tensor that has the same element.</p>
<p>2.View can only operate on an untagged tensor.</p>
<p>3.View requires a contiguous tensor.</p>
</div></blockquote>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>dimer:</dt>
<dd>The new shape of the UniTensor. This should be a python list.</dd>
<dt>rowrank:</dt>
<dd>The number of bonds in row space.</dd>
<dt>new_labels:</dt>
<dd>The new labels that will be set for new bonds after reshape.</dd>
</dl>
</div></blockquote>
<p>reture:</p>
<blockquote>
<div>UniTensor</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 6         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">           |           3 |____ 5  </span>
<span class="go">           \             /     </span>
<span class="go">            ------------- </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Contiguous_</span><span class="p">()</span> <span class="c1"># this is needed. </span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">View</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">new_labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     1 ____| 2         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">     2 ____| 3         3 |____ -1 </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.View_">
<code class="descname">View_</code><span class="sig-paren">(</span><em>dimer</em>, <em>rowrank</em>, <em>new_labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.View_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.View_" title="Permalink to this definition">¶</a></dt>
<dd><p>Inplace version of View. 
View UniTensor into the shape specified as [dimer], with the first [rowrank] Bonds as bra-bond and other bonds as ket-bond.</p>
<p>The View_() can only operate on a contiguous tensor, otherwise, Contiguous_() or Contiguous() need to be called before the tensor can be viewed. This is the inplace version of pytorch.view().</p>
<p>[Note]</p>
<blockquote>
<div><p>1.Viewing a UniTensor physically re-define the bra-ket basis space, which construct a new physical definition tensor that has the same element.</p>
<p>2.Viewing can only operate on an untagged tensor.</p>
<ol class="arabic simple" start="3">
<li>View_() requires a contiguous tensor.</li>
</ol>
</div></blockquote>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>dimer:</dt>
<dd>The new shape of the UniTensor. This should be a python list.</dd>
<dt>rowrank:</dt>
<dd>The number of bonds in row space.</dd>
<dt>new_labels [option]:</dt>
<dd>The new labels that will be set for new bonds after reshape. If not set, the label will be initialize using default enumerate rule.</dd>
</dl>
</div></blockquote>
<p>Return:</p>
<blockquote>
<div>self</div></blockquote>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 6         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">           |           3 |____ 5  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Permute</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Contiguous_</span><span class="p">()</span> <span class="c1"># this is needed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Reshape_</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">new_labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     1 ____| 2         5 |____ 3  </span>
<span class="go">           |             |     </span>
<span class="go">     2 ____| 3         3 |____ -1 </span>
<span class="go">           \             /     </span>
<span class="go">            -------------</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.Whole_transpose">
<code class="descname">Whole_transpose</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.Whole_transpose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.Whole_transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>If the UniTensor is tagged, exchange the bra/ket tags on each bond, and transpose (rowspace and colspace) by referencing to the “rowrank”.</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>UniTensor, shared the same type with each bond’s tag bra &lt;-&gt; ket exchanged.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.backward">
<code class="descname">backward</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.backward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.backward" title="Permalink to this definition">¶</a></dt>
<dd><p>Backward the gradient flow in the contructed autograd graph. This is the same as torch.Tensor.backward</p>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.braket_form">
<code class="descname">braket_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.braket_form"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.braket_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute the UniTensor to bra-ket form.</p>
<p>[Tech.Note] the permuted UniTensor can be non-contiguous depending on the underlying memory layout.</p>
<dl class="docutils">
<dt>Return :</dt>
<dd>self</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.detach">
<code class="descname">detach</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.detach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach the current tensor from the current graph, making it a leaf. This is the same as torch.Tensor.detach_()</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>self</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="tor10.UniTensor.UniTensor.device">
<code class="descname">device</code><a class="headerlink" href="#tor10.UniTensor.UniTensor.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the device of UniTensor</p>
<p>Return:</p>
<blockquote>
<div>torch.device</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="tor10.UniTensor.UniTensor.dtype">
<code class="descname">dtype</code><a class="headerlink" href="#tor10.UniTensor.UniTensor.dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the device of UniTensor</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>torch.type</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.grad">
<code class="descname">grad</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the gradient tensors subject to x where x is the current UniTensor. The return is None by default and becomes a UniTensor the first time a call backward(). The future calls to backward() will accumulate (add) gradient into it.</p>
<p>This is the same as torch.Tensor.grad</p>
<p><span class="math notranslate nohighlight">\(d/dx\)</span></p>
<dl class="docutils">
<dt>Return:</dt>
<dd>UniTensor, the shape of the return UniTensor and it’s bonds are the same as the original UniTensor, but with default labels.</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">Tensor name:</span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[0., 0.],</span>
<span class="go">        [0., 0.]], dtype=torch.float64, requires_grad=True)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">Tensor name:</span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[16., 16.],</span>
<span class="go">        [16., 16.]], dtype=torch.float64, grad_fn=&lt;PowBackward0&gt;)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Mean</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">Tensor name:</span>
<span class="go">is_diag    : False</span>
<span class="go">tensor(16., dtype=torch.float64, grad_fn=&lt;MeanBackward1&gt;)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">out</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">grad</span><span class="p">())</span>
<span class="go">Tensor name:</span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[2., 2.],</span>
<span class="go">        [2., 2.]], dtype=torch.float64)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.is_braket_form">
<code class="descname">is_braket_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.is_braket_form"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.is_braket_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return if the current tensor is in braket_form. It can only be called on a tagged UniTensor (with or without symmetry)</p>
<p>Return:</p>
<blockquote>
<div>bool.</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.is_contiguous">
<code class="descname">is_contiguous</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.is_contiguous"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.is_contiguous" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the status of memory contiguous.</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>bool, if True, then the Storage of UniTensor is contiguous. if False, then the Storage of UiTensor is non-contiguous.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.item">
<code class="descname">item</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.item"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.item" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the python scalar from a UniTensor with one element</p>
<dl class="docutils">
<dt>Return:</dt>
<dd>python scalar</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.requires_grad">
<code class="descname">requires_grad</code><span class="sig-paren">(</span><em>is_grad=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.requires_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.requires_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>The status for the autograd property.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>is_grad:</dt>
<dd>bool, if the autograd mechanism should be activate on this UniTensor.
If the argument is not set, it will return the current autograd status.</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd>bool, return only when is_grad argument is ignored.</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bds_x</span> <span class="o">=</span> <span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="n">bds_x</span><span class="p">,</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">())</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="tor10.UniTensor.UniTensor.shape">
<code class="descname">shape</code><a class="headerlink" href="#tor10.UniTensor.UniTensor.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the shape of UniTensor</p>
<p>Return:</p>
<blockquote>
<div>torch.Size</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.to">
<code class="descname">to</code><span class="sig-paren">(</span><em>device</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.to" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the current UniTensor to device. If device is not the same with current tensor, return a new UniTensor, otherwise return self.</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>device:</dt>
<dd>This should be an [torch.device]
torch.device(“cpu”) for put the tensor on host (cpu)
torch.device(“cuda:x”) for put the tensor on GPU with index x</dd>
</dl>
</div></blockquote>
<p>Return:</p>
<blockquote>
<div>self if the device if the same as current UniTensor. Otherwise, return a new UniTensor</div></blockquote>
<p>Example:</p>
<blockquote>
<div><p>Construct a tensor (default is on cpu)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Set to GPU.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">b</span> <span class="ow">is</span> <span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.to_">
<code class="descname">to_</code><span class="sig-paren">(</span><em>device</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.to_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.to_" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the current UniTensor to device</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>device:</dt>
<dd>This should be an [torch.device]
torch.device(“cpu”) for put the tensor on host (cpu)
torch.device(“cuda:x”) for put the tensor on GPU with index x</dd>
</dl>
</div></blockquote>
<p>Return:</p>
<blockquote>
<div>self</div></blockquote>
<p>Example:</p>
<blockquote>
<div><p>Construct a tensor (default is on cpu)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Set to GPU.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">to_</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="tor10.UniTensor.UniTensor.torch">
<code class="descname">torch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#UniTensor.torch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.UniTensor.torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a UniTensor to torch.Tensor.</p>
<blockquote>
<div><p>[Note]</p>
<blockquote>
<div><ol class="arabic simple">
<li>this cannot be operate on a UniTensor with symmetry.</li>
<li>the return tensor will not share the same memory with the UniTensor.</li>
</ol>
</div></blockquote>
</div></blockquote>
<p>Return:</p>
<blockquote>
<div>torch.Tensor</div></blockquote>
</dd></dl>

</dd></dl>

<span class="target" id="module-tor10.UniTensor"></span><dl class="function">
<dt id="tor10.UniTensor.Contract">
<code class="descclassname">tor10.UniTensor.</code><code class="descname">Contract</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#Contract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.Contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Contract two tensors with the same labels.</p>
<ol class="arabic simple">
<li>two tensors must be the same type, if “a” is a symmetry/untagged/tagged tensor, “b” must also be a symmetry/untagged/tagged tensor.</li>
<li>When contract two symmetry tensor, the bonds that to be contracted must have the same qnums.</li>
<li>For tagged tensor, Each bra-bond can only contract with ket-bond, in terms of physical meaning, this means the contract traceing out the matched bra-ket.</li>
</ol>
<p>[Note] the argument “a” and “b” tensor defines the order of the out-come bond. After contract,  the order of remaining bonds (both in-bond(bra) and out-bond(ket)) that appears in the new-tensor will follows the rule: a’s in-bond will appears first, then the b’s in-bond; a’s out-bond will appears first, then b’s out-bond (see example in below)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>a:</dt>
<dd>UniTensor</dd>
<dt>b:</dt>
<dd>UniTensor</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd>UniTensor</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">6</span><span class="p">)],</span> <span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     6 ____| 5         4 |____ 7  </span>
<span class="go">           |             |     </span>
<span class="go">     1 ____| 2         3 |____ 8  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------   </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 4</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     7 ____| 4         3 |____ 10 </span>
<span class="go">           |             |     </span>
<span class="go">     2 ____| 2         6 |____ 9  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 6</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     6 ____| 5         3 |____ 8  </span>
<span class="go">           |             |     </span>
<span class="go">     1 ____| 2         3 |____ 10 </span>
<span class="go">           |             |     </span>
<span class="go">     2 ____| 2         6 |____ 9  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 6</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     2 ____| 2         3 |____ 10 </span>
<span class="go">           |             |     </span>
<span class="go">     6 ____| 5         6 |____ 9  </span>
<span class="go">           |             |     </span>
<span class="go">     1 ____| 2         3 |____ 8  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
<p>Note that you can also contract for UniTensor with symmetry, even when they are not in the bra-ket form. As long as the quantum number on the to-be-contract bonds and the bond type matches (bra can only contract with ket)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bd_sym_1a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">bd_sym_2a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">bd_sym_3a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">]])</span>

<span class="n">bd_sym_1b</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">bd_sym_2b</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_BRA</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">bd_sym_3b</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">tor10</span><span class="o">.</span><span class="n">BD_KET</span><span class="p">,</span><span class="n">qnums</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">]])</span>

<span class="n">sym_A</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">bd_sym_1a</span><span class="p">,</span><span class="n">bd_sym_2a</span><span class="p">,</span><span class="n">bd_sym_3a</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">sym_B</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">bd_sym_2b</span><span class="p">,</span><span class="n">bd_sym_1b</span><span class="p">,</span><span class="n">bd_sym_3b</span><span class="p">],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_A</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : True</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">    10 &gt; __| 3         5 |__ &lt; 12 </span>
<span class="go">           |             |     </span>
<span class="go">    11 &gt; __| 4           |        </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_B</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 3</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : False</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">    11 &lt;*__| 4         3 |__ &lt; 10 </span>
<span class="go">           |             |     </span>
<span class="go">           |           7 |__*&gt; 7  </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_AB</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">sym_A</span><span class="p">,</span><span class="n">sym_B</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym_BA</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Contract</span><span class="p">(</span><span class="n">sym_B</span><span class="p">,</span><span class="n">sym_A</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sym_AB</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : False</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">    12 &lt;*__| 5         7 |__*&gt; 7  </span>
<span class="go">           |             |     </span>
<span class="go">           ---------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sym_BA</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: True</span>
<span class="go">on device     : cpu</span>
<span class="go">braket_form : True</span>
<span class="go">      |ket&gt;               &lt;bra| </span>
<span class="go">           ---------------      </span>
<span class="go">           |             |     </span>
<span class="go">     7 &gt; __| 7         5 |__ &lt; 12 </span>
<span class="go">           |             |     </span>
<span class="go">           --------------- </span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tor10.UniTensor.From_torch">
<code class="descclassname">tor10.UniTensor.</code><code class="descname">From_torch</code><span class="sig-paren">(</span><em>torch_tensor</em>, <em>rowrank=None</em>, <em>labels=None</em>, <em>is_tag=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#From_torch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.From_torch" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct UniTensor from torch.Tensor.</p>
<p>If the input torch_tensor belongs to a autograd graph, the contructed UniTensor will preserve the role of the input torch_tensor in the computational graph.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>torch_tensor:</dt>
<dd>Torch.Tensor</dd>
<dt>rowrank:</dt>
<dd>int, The number of inbond. Note that the first [rowrank] bonds will be set to tor10.BD_IN, and the remaining bonds will be set to tor10.BD_OUT</dd>
<dt>labels:</dt>
<dd>python list or 1d numpy array, The labels for each bonds. If ignore, the constucted UniTensor will using the default labels for each bond.</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd>UniTensor</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">tensor([[1., 1., 1.],</span>
<span class="go">        [1., 1., 1.],</span>
<span class="go">        [1., 1., 1.]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">From_torch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">Print_diagram</span><span class="p">()</span>
<span class="go">-----------------------</span>
<span class="go">tensor Name : </span>
<span class="go">tensor Rank : 2</span>
<span class="go">has_symmetry: False</span>
<span class="go">on device     : cpu</span>
<span class="go">is_diag       : False</span>
<span class="go">            -------------      </span>
<span class="go">           /             \     </span>
<span class="go">     4 ____| 3         3 |____ 5  </span>
<span class="go">           \             /     </span>
<span class="go">            -------------  </span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">Tensor name:</span>
<span class="go">is_diag    : False</span>
<span class="go">tensor([[1., 1., 1.],</span>
<span class="go">        [1., 1., 1.],</span>
<span class="go">        [1., 1., 1.]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
<span class="go">tensor([[1., 1., 1., 1.],</span>
<span class="go">        [1., 1., 1., 1.],</span>
<span class="go">        [1., 1., 1., 1.]], requires_grad=True)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y2</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">From_torch</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y2</span><span class="o">.</span><span class="n">requires_grad</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tor10.UniTensor.Load">
<code class="descclassname">tor10.UniTensor.</code><code class="descname">Load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#Load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.Load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a UniTensor from the file.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>filename:</dt>
<dd>The path of the file to be loaded</dd>
</dl>
</dd>
<dt>Return:</dt>
<dd>UniTensor</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">Load</span><span class="p">(</span><span class="s2">&quot;a.uniT&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="tor10.UniTensor.Save">
<code class="descclassname">tor10.UniTensor.</code><code class="descname">Save</code><span class="sig-paren">(</span><em>a</em>, <em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tor10/UniTensor.html#Save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#tor10.UniTensor.Save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a UniTensor to the file</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>a:</dt>
<dd>The UniTensor that to be saved.</dd>
<dt>filename:</dt>
<dd>The saved file path</dd>
</dl>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">tor10</span><span class="o">.</span><span class="n">UniTensor</span><span class="p">(</span><span class="n">bonds</span><span class="o">=</span><span class="p">[</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">tor10</span><span class="o">.</span><span class="n">Bond</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="n">rowrank</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">tor10</span><span class="o">.</span><span class="n">Save</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s2">&quot;a.uniT&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Network.html" class="btn btn-neutral float-right" title="tor10.Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Bond.html" class="btn btn-neutral" title="tor10.Bond" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Kai-Hsin Wu

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>